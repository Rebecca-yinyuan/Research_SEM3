Roughly finish simulating the hybrid method with non-constant within-host system. 
Note that we use an event queue to decide which events would happened next
